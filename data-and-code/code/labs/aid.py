'''
    Implementation of the aggregate and disaggregate algorithm
'''